{
	"nodes":[
		{"id":"4230e7f2b1240c86","type":"text","text":"# Disk Quota Management on XFS Filesystem","x":-340,"y":-340,"width":680,"height":78,"color":"3"},
		{"id":"79473ee689014429","type":"text","text":"#xfs_quota\nThis is utility use to manage the quota in `xfs` file system\n\nNow, \n1. press `xfs_quota` then you go inside it you will see\n2. `xfs_quota> help` if you don't know anything type `help`\n3. It will show many option you can use it like\n4. `xfs_quota> df` here when you type `help` you will see the option `df`\n5. to come out of this simply type `xfs_quota> quit`\n6. By the way this is basic mode we will use `expert mode`.\n\n# here\n\n1. `xfs_quota -x -c report /xfs_quota_dir` it will show the `quota details`\n\t1. `-x` meaning expert mode\n\t2. `-c` meaning we are managing quota using command line\n\t3. `report` meaning we want details\n\t4. `/xfs_quota_dir` meaning on which filesystem you want to see the details\n\t5. `details` will be about `User`, `Groups` and `projects` it will be visible in good table format\n\n\n# Setting block limit for user `deepak`\n\n1. `xfs_quota -x -c 'limit bsoft=1g bhard=1536m deepak' /xfs_quota_dir`\n\t1. setting block `soft` or `hard` limit for user `deepak`\n\t2. `bsoft=1g` setting soft limit of `lGB`\n\t3. `bhard=1536m` setting hard limit of `1536 MB`\n2. `xfs_quota -x -c report /xfs_quota_dir` this will show the details of `quota`\n\t1. you will see in `User` columns we have `deepak` entry with `block soft and hard-limit`\n\t2. also, grace period column is empty for user `deepak` because we didn't exceed the `soft-limit` yet\n\n### checking quota limit for user `deepak`\n\n1. Let's check `quota limit` for user `deepak`\n2. `su -deepak`\n3. `cd /xfs_quota_dir`\n4. let's create file for specific size\n\t1. we can use `dd command` to make file \n\t2. or can use `fallocate command`\n5. `fallocate -l 1.2G /xfs_quota_dir/textfile.txt`\n6. `ls -lh` you will see the `textfile` inside `xfs_quota_dir` having size `1.2GB`\n\t1. here we are crossing the `1GB size` which is `soft-limit`\n\t2. so if you run  `xfs_quota -x -c report /xfs_quota_dir` then this time you will see `grace period` which is `7days by fefault`\n7.  `fallocate -l 400M /xfs_quota_dir/textfile2.txt` it failed because it exceeded the `hard-limit`\n\n\n\n# Setting I-Node limit for user `deepak`\n\n1. `xfs_quota -x -c 'limit isoft=10 ihard=15 deepak' /xfs_quota_dir`\n\t 1. setting I-Node `soft` or `hard` limit for user `deepak`\n\t 2. `isoft=10` setting` soft I-Node limit` of `10 file`\n\t 3. `bhard=15` setting hard `I-Node limit` of `15 file`\n2. to see the details of `I-Node` run \n\t1. `xfs_quota -x -c \"report -bih\" /xfs_quota_dir`\n\t\t1. here `-ibh` meaning show details of `I-Node and block both in human readable format`\n\t2. `xfs_quota -x -c \"report -ih\" /xfs_quota_dir`\n\t\t1. only show `I-Node` details\n\n\n### checking quota limit for user `deepak`\n\n1. Let's check `I-Node quota limit` for user `deepak`\n2. `su -deepak`\n3. `cd /xfs_quota_dir`\n4. `touch file{1..12}.txt`\n5. `ls -lh` you will see the `files from file1 to file12` inside `xfs_quota_dir` having total `12 file`\n\t1. here we are crossing the `10 files limit` which is `soft-limit`\n\t2. so if you run  `xfs_quota -x -c \"report -bih\" /xfs_quota_dir` then this time you will see `grace period` which is `7days by fefault`\n6.  `touch file{13..17}.txt` it failed because it exceeded the `hard-limit`\n\n\n# See Step  3 ---->","x":-100,"y":-220,"width":1060,"height":1980,"color":"5"},
		{"id":"a31f045f46ac2bd4","type":"text","text":"Step 2","x":413,"y":-300,"width":250,"height":60,"color":"3"},
		{"id":"5c1f0fdb8f620df7","type":"text","text":"# How to make Quota on `xfs`\n\n1. create `partition /dev/sda1` on `/dev/sda disk`\n2. `mkfs.xfs /dev/sda`'\n3. `blkid /dev/sdba` for `UUID`\n\nHere, : `For creating quota on disk we require quota package` so let's check whether it is present in system or not\n4. `rpm -qa quota` will give package name \n5. `yum list installed quota` will give package name it don't then install it\n6. `dnf install -y quota`\n\nAlso because `disk quota` is permission which assign to someone it can be \n1. `Users`\n2. `Groups` \n\t1. so let's add `users` and `gruops`\n\t2. `useradd deepak\n\t3. `useradd vishal`\n\t4. `groupadd admin44` --> making group name as `admin44`\n\t5. `cat /etc/group | grep admin44` this will show the group made with name `admin44`\n\t6. `usermod -g admin44 vishal` --> adding `user vishal` to `admin44` group here `-g` meaning primary group meaning `making default group`\n\t7. `cat /etc/passwd | grep vishal` will show user `vishal` information \n\t8. `id vishal` will show `user deepak` information with `group` in which he is belonging\n\nNow,\n\n7. `mkdir /xfs_quota_dir`\n8. `vim /etc/fstab` for permanent mounting\n9. `/dev/sda1   /xfs_quota_dir   xfs   defaults   0   0`\n10. `mount -a` This will mount `/dev/sda1` on `/xfs_quota_dir` permanently\n11. let's check whether quota is enabled or not\n12. `mount | grep xfs_quota_dir` this command show `noquota` because we haven't enable quota in `/etc/fstab` yet \n\n##### Let's configure quota in `/etc/fstab`\n### Step 1 --> Enabling `quota`\n\n1. `vim /etc/fstab`\n2. `/dev/sda1   /xfs_quota_dir   defaults,usrquota,grpquota,prjquota   0   0`\n\t1. `/dev/sda1` is disk partition which is `mounted on /xfs_quota_dir` having `user-quota, group-quota and project quota` enable \n\t2. `usrquota` or `uquota` anyone both of them can used\n\t3. `grpquota` or `gquota` anyone both of them can used\n\n***\n\n### Step 2 --> Remounting the file-system\n\n1. Because enabling quota on `/etc/fstab` won't reflect to machine meaning machine don't know about change wo we have to remount the filesystem\n2. `mount -0 remount /xfs_quota_dir`\n3. `mount | grep xfs_quota_dir` you will see the information with `user-quota, group-quota and project-quota` enabled\n4. if still you are not able to see the  information like `user-quota, group-quota and project-quota` \n5. then `umount /xfs_quota_dir`\n6. `mount -a` it will do the job\n\n# See step 2 for further -->\n\n\n","x":-1200,"y":-220,"width":1065,"height":1520,"color":"1"},
		{"id":"d5071fb39c656b93","type":"text","text":"\n# NOTE : \n#### user is `deepak` and group name is `admin44`\n\n1. `If you want to define user and group quota limit` you can do in `SIngle command`\n\t1. `xfs_quota -x -c 'limit -u bsoft=500M bhard=800M deepak' -c 'limit -g bsoft=600M bhard=900M admin44' /xfs_quota_dir`\n\t2. you can define `I-Node quota` as well like \n\t\t1. `xfs_quota -x -c 'limit -u bsoft=500M bhard=800M deepak' -c 'limit -g bsoft=600M bhard=900M admin44' -c 'limit -u isoft=5 ihard=10 deepak' /xfs_quota_dir`\n2. see to details of `user` and `group` at same time\n\t1. `xfs_quota -x -c \"report -i=bih\" /xfs_quota_dir` will show both of `users` and `groups` quota limit details\n\n\n# Here, Because our group `admin44` has member name `vishal` so let's check group quota limit that we have set\n\n\n1. `su -vishal`\n2. `xfs_quota -x -c \"limit -g isoft=10 ihard=15 admin44\" /xfs_quota_dir`\n3. `because quota-limit is already set on group \"admin44\" so any user belonging to this group also have the same quota limit` so,\n4. `touch vishal{1..10}.txt` valid follow the `I-Node soft limit` which is `10 files`\n5. `touch vishal{11..14}.txt` warning but allowed follow the `I-Node hard limit` which is `15 files`\n6. `touch vishal{15..16}.txt` failed exceeding `I-Node hard limit`\n\n\n# Project quota limit\n***Note*** : `project quota is used to set quota limit on directory`\n \n1. we need to do entry in `/etc/projid` and `/etc/projects` to implement `project quota`\n2. `echo testquota:11 >> /etc/projid` \n\t1. `testquota:11` here `testquota is project quota` and `11` is its `id`\n\t2. this command do entry of `testquota:11` in `/etc/projid`\n\t3. `>>` meaning `append` not `over-ride` the content\n3. `echo 11://xfs_quota_dir >> /etc/projects` here we tell for which filesystem we are using `id 11` so here filesystem is `xfs_quota_dir`\n\t1. `xfs_quota_dir` is `xfs formatted /dev/sda1 patition file system don't forget`\n\n***Till here we made `testquota project`***\nNow,\n\n# Now set `project quota`\n\n1. `xfs_quota -x -c 'project -s projectname' project_path`\n\t1.  `xfs_quota -x -c 'project -s testquota' /xfs_quota_dir` \n\t\t1. `testquota` is project name that you mentioned in `/etc/projid`\n\t\t2. `/xfs_quota_dir` is file system that we mentioned in `/etc/projects`\n2. `xfs_quota -x -c \"print\" /xfs_quota_dir` will show `project quota details`\n\t1. `print` keyword is important for seeing `project quota` details\n3. `xfs_quota -x -c \"report -pbih\" /xfs_quota_dir` \n\t1. This command show details of `project quota`, `block quota`, and `I-Node quota`\n4. `xfs_quota -x -c 'limit -p bsoft=200M bhard=500M testquota' /xfs_quota_dir`\n\t1. `-p` represent `project quota`\n5. `xfs_quota -x -c \"report -pbih\" /xfs_quota_dir`  you will see the details `block soft-hard limit` for `testquota project quota`\n6. `xfs_quota -x -c 'limit -p isoft=20 ihard=50 testquota' /xfs_quota_dir`\n5. `xfs_quota -x -c \"report -pbih\" /xfs_quota_dir`  you will see the details `I-Node soft-hard limit` for `testquota project quota`\n\n# Let's test `Project quota`\n\n1. `dd if=/dev/urandom of=/xfs_quota_dir/test_file` this will create unlimited length of file until or unless disk storage is completely filled\n2. The above command give error because the `hard-limit` that we have set above is `500MB`\n3. `ls -lh /xfs_quota_dir` so on directory `/xfs_quota_dir` we had set the `block hard-limit = 500MB`\n\n\n***NOTE*** : \n1. `testquota` is `project name`\n2. `/xfs_quota_dir` is the directory where `project quota` is set. in this directory we are going to check `project quota limit`\n\n\n# If you want to see state of any `quota related filesystem` \n\n1. `xfs_quota -x -c \"state\" /xfs_quota_dir`\n\t1. `User quota state :`\n\t\t1. `Accounting : ON` meaning `quota` implemented\n\t\t2. `Enforcement: ON` meaning `quota` it is implementing rightfully\n2. `same for group quota` and `project quota` \n\n\n\n# How to change `grace period` or `Timer`\n\n#### For `Block limit`\n\n1. `xfs_quota -x -c 'timer -p -b 10days' /xfs_quota_dir` this command set `grace period` of `block limit` for `project quota`\n\t1. `-p` represents `project quota`\n\t2. `-b`  represents `block limit`\n2. `xfs_quota -x -c \"state -p\" /xfs_quota_dir` for state details\n\t1. make sure to use `-p` option for latest `porject quota` state \n\n#### For `I-Node`\n1. `xfs_quota -x -c 'timer -p -i 10days' /xfs_quota_dir` this command set `grace period` of `I-Node limit` for `project quota`\n\t1. `-p` represents `project quota`\n\t2. `-i`  represents `I-Node limit`\n\n\n#### For `Real time`\n1. `xfs_quota -x -c 'timer -p -r 10days' /xfs_quota_dir` this command set `grace period` of `Real time` for `project quota`\n\t1. `-p` represents `project quota`\n\t2. `-r`  represents `Real time`","x":1000,"y":-220,"width":1100,"height":2580,"color":"1"},
		{"id":"b8a09bb20762d114","x":1000,"y":-288,"width":250,"height":60,"color":"3","type":"text","text":"Step 3"},
		{"id":"460ba7de7179d306","type":"text","text":"Step 1","x":-1200,"y":-300,"width":250,"height":60,"color":"3"},
		{"id":"debedc0672904e93","x":2140,"y":-220,"width":740,"height":840,"color":"5","type":"text","text":"# How to disable `User quota`\n\n1. `xfs_quota -x -c \"disable -uv\" /xfs_quota_dir`\n\t1. `-u` meaning `User quota`\n\t2. `uv` here `v` meaning `verbose`\n\t3. also this command give :\n\t\t1. `Accounting : ON` meaning `quota` implemented\n\t\t2. `Enforcement: OFF` meaning `quota` it is not  implementing\n2. `xfs_quota -x -c \"state\" /xfs_quota_dir` you can also see state. This gives\n\t1. `Accounting : ON` meaning `quota` implemented\n\t2. `Enforcement: OFF` meaning `quota` it is not  implementing\n3. Now user `deepak` can create any size of file.\n\n\n# How to disable `Project quota`\n\n1. `xfs_quota -x -c \"disable -pv\" /xfs_quota_dir`\n\t1. `-p` meaning `Project quota`\n\n\n\n# How to disable `Group quota`\n\n1. `xfs_quota -x -c \"disable -gv\" /xfs_quota_dir`\n\t1. `-g` meaning `Group quota`\n\n\n\n# How to Enable `quota`\n\n1. `xfs_quota -x -c \"disable -ugpv\" /xfs_quota_dir`\n\t1. enabling `user, group and project quota at once`"},
		{"id":"918aab71e1b0ca0d","x":2140,"y":-300,"width":250,"height":60,"color":"3","type":"text","text":"Step 4"},
		{"id":"5192c02b3ecfbaca","x":2140,"y":660,"width":250,"height":60,"color":"3","type":"text","text":"Step 5"},
		{"id":"76681484f6f833c9","type":"text","text":"# How to Permanent disabled `User quota`\n\n1. `xfs_quota -x -c \"off -uv\" /xfs_quota_dir`\n\t1. this command give :\n\t\t1. `Accounting : OFF` meaning `quota` not implemented\n\t\t2. `Enforcement: OFF` meaning `quota` it is not  implementing\n2. `xfs_quota -x -c \"state\" /xfs_quota_dir` you can also see state. This gives\n\t1. `Accounting : OFF` meaning `quota` not implemented\n\t2. `Enforcement: OFF` meaning `quota` it is not  implementing\n3. `mount | grep /xfs_quota_dir` you will see `no user quota` it is permanently disabled\n4. Also remove `/etc/fstab` entry\n \n","x":2140,"y":740,"width":740,"height":420,"color":"5"}
	],
	"edges":[]
}