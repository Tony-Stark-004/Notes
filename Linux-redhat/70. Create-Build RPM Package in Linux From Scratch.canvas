{
	"nodes":[
		{"id":"8dad34b2060a9db9","type":"text","text":"# Create/Build RPM Package in Linux From Scratch\n\n```\n1. yum repolist all\n   \nğŸ‘‰ğŸ‘‰ This will show whether your local repository is configured or not. Also this command give you warnings if you don't have subscription\n```\n\n##### To create or build the RPM package we need to configured the Local yum repository\n\n```\nğŸ‘‰ğŸ‘‰ go to the /etc/yum.repos.d and create the local repository\n1. cd /etc/yum.repos.d\n2. vim local.repo\n```\n\n![[Pasted image 20250121233353.png]]\n\nNOTE: `baseurl = file:///mnt/BaseOS` it means our ISO image is mounted on `/mnt` directory\n* `mount /dev/sr0 /mnt`\n* Make sure to attach the ISO image first then try to mount\n\n```\n3. yum repolist all\nğŸ‘‰ğŸ‘‰ This time it will show you the configured local repository.\n```","x":-532,"y":-580,"width":872,"height":1060},
		{"id":"9515ee7c99c09a0e","type":"text","text":"# Create/Build RPM Package in Linux From Scratch","x":-200,"y":-680,"width":720,"height":66,"color":"3"},
		{"id":"2ed85dfa7f5930c8","type":"text","text":"Step 1","x":-532,"y":-647,"width":120,"height":60,"color":"3"},
		{"id":"7d2c38220d55ce96","type":"text","text":"```\nWhen we build and create the RPM repo we need some directories which comes under the `rpmbuild` directory and we don't need to create those directory manually we can just need some packages which automatically can create the directories and this is the reason for which we configured the Local repository\n```\n\n```\n1. yum install -y rpmdevtools rpm-build\nğŸ‘‰ğŸ‘‰ This two package we need and using these two packages command we can create structured directories that we need\n\n2. move or delete the local repository that we configured in /etc/yum.repos.d\nğŸ‘‰ mv /etc/yum.repos.d/local.repo /tmp \n\n3. yum repolist all\nğŸ‘‰ğŸ‘‰ It give know warning about subscription because no local repository is configured\n\n4. We always use normal user to create/build the RPM package. Never use the root user\nğŸ‘‰ su - vikasnehra\n\n5. rpmdev-setuptree\nğŸ‘‰ This command create the rpmbuild name directory\n\n6. cd rpmbuild\n7. ls\n\n8. tree rpmbuild\nğŸ‘‰ This will show you rpmbuild child or sub directory in tree format\n\n\n```\n\n\n","x":360,"y":-580,"width":872,"height":1060},
		{"id":"1613b6bc8babe040","type":"text","text":"Step 2","x":1120,"y":-647,"width":112,"height":60,"color":"3"},
		{"id":"1d55626a3d95f8bf","type":"text","text":"![[Pasted image 20250122000404.png]]\n\n* `RPMS/SRPMS` is the directory where `RPM` files comes after build or create\n* `SOURCES` is the directory where code for creating RPM file is kept","x":1280,"y":-180,"width":400,"height":560,"color":"3"},
		{"id":"0a22e390e8bbcc12","x":1280,"y":-660,"width":760,"height":460,"color":"2","type":"text","text":"* `BUILD` --> This is the folder where all of the files go which are created during a build of the package you want to create\n***\n\n* `RPMS/SRPMS` --> If your build is successful this is the folder there the final rpm file will be created . The SRPMS folder only contains source rpm\n***\n\n* `SOURCES` --> This is the folder where you want to put the source tar file or/ and additional files such as init.d/systemd files\n***\n\n* `SPECS` --> The SPECS folder contains all set of instructions on how to build the RPM package and all"},
		{"id":"a03dccb95b00eb49","x":-532,"y":500,"width":132,"height":60,"color":"3","type":"text","text":"Step 3"},
		{"id":"ef5d5739ca738eea","x":-532,"y":580,"width":892,"height":3440,"color":"3","type":"text","text":"```\nStep 1 --> move to SOURCES directory present inside the rpmbuild\n\n1. cd rpmbuild/SOURCES\n\n2. mkdir -p localrepo-1/etc/yum.repos.d/\nğŸ‘‰ğŸ‘‰ Make sure to keep the directory name as `any-name/etc/yum.repos.d`\n\n3. cd /localrepo-1/etc/yum.repos.d/\n\n4. vim /RHEL8local.repo\nğŸ‘‰ğŸ‘‰ vim create and open the file /REHEL8local.repo and keep in mind we made this inside the /localrepo-1/etc/yum.repos.d\n\n---- This file /RHEL8local.repo contains ğŸ‘‡ğŸ‘‡ ----\n```\n![[Pasted image 20250123003745.png]]\n\n```\nMake sure because we gave the baseurl=file:///mnt/AppStream like that it means our ISO image is mounted on /mnt directory so when we going to install any package after creating and building of this RPM package make sure to mount the ISO image on /mnt directory\n```\n\n```\n5. tar -cvzf localrepo-1.tar.gz localrepo-1\nğŸ‘‰ğŸ‘‰ make zip of localrepo-1 directory Which me made inside SOURCES \n\n6. Let's create SPECS for our RPM package\n7. rpmdev-newspec localrepo.spec\n\n8. vim localrepo.spec\nğŸ‘‰ğŸ‘‰ This file contains data as\n```\n\n![[Pasted image 20250123005349.png]]\n\n![[Pasted image 20250123005712.png]]\n\n![[Pasted image 20250123010059.png]]\n\n```\n9. rpmbuild -v -bb rpmbuild/SPEC/localrepo.spec\nğŸ‘‰ğŸ‘‰ Building the localspec.spec that we create\n\n10. cd /RPMS\nğŸ‘‰ğŸ‘‰ Make sure to give the correct path to change the directory\n\n11. ls\nğŸ‘‰ğŸ‘‰ You will see the noarch directory\n\n12. cd /noarch\n13. ls\nğŸ‘‰ğŸ‘‰ you will see localrepo-1-0.noarch.rpm. Let's install it\n\n14. rpm -qpl localrepo-1-0.noarch.rpm\nğŸ‘‰ğŸ‘‰ Because on creating file SPECS we give the file creation location after installation which is /etc/yum.repos.d/RHEL8local.repo. Also make sure to give correct path of .rpm file while testing. Here we are testing not installing\n\n15. su - root-user\n16. rpm -ivh /home/vikashnehra/rpmbuild/RPMS/noarch/localrepo-1-0.noarch.rpm\nğŸ‘‰ğŸ‘‰ complete .rpm package path and it will install and setup the local repository for you\n\n17. ls /etc/yum.repos.d\nğŸ‘‰ğŸ‘‰ This will show you the local repositroy configured now you can install packages. Also make to attach ISO image and mount it on /mnt directory\n\n18. yum repolist all \nğŸ‘‰ğŸ‘‰ Shows you whether repolist is configured and enabled or not\n19. yum install -y httpd\n\n```"},
		{"id":"f4767ee5cacd36d2","x":380,"y":700,"width":740,"height":960,"type":"text","text":"#### `%files` \n```\n1. %defattr(-, root, root, -)\nğŸ‘‰ğŸ‘‰ Here - indicates normal file ,\nğŸ‘‰ğŸ‘‰ root indicates owner is root\nğŸ‘‰ğŸ‘‰ root indicates group owner is root\nğŸ‘‰ğŸ‘‰ - indicates no permission for others users\n\n2. /etc/yum.repos.d/RHEL8local.repo\nğŸ‘‰ğŸ‘‰ create file in /etc/yum.repos.d named as RHEL8local.repo\n```\n\n#### `BuildArch`\n```\n1. noarch\nğŸ‘‰ğŸ‘‰ Meaning any type whether 32bit or 64bit machine both can install this package\n```\n\n#### `BuildRoot`\n```\n1. %{_tmppath}/%{name}-buildroot\nğŸ‘‰ğŸ‘‰ This is the temporary path where RPM is look for packages files\n```\n\n#### `Source0`\n```\n1. localrepo-1.tar.gz\nğŸ‘‰ğŸ‘‰ Make sure to give correct source gip file that we crate \n```"}
	],
	"edges":[
		{"id":"65f6372087a2c63e","fromNode":"1d55626a3d95f8bf","fromSide":"left","toNode":"7d2c38220d55ce96","toSide":"right"}
	]
}