{
	"nodes":[
		{"id":"08852ce47e8fda00","type":"text","text":"# Disk Quota Management on EXT4 Filesystem","x":-20,"y":-340,"width":680,"height":80,"color":"3"},
		{"id":"aa7d1ca938918906","type":"text","text":"step 2","x":748,"y":-320,"width":250,"height":60,"color":"3"},
		{"id":"fa4d43b4d999d0cf","type":"text","text":"* `Soft limit` --> Allowing user to make `10 file` but it exceeds then allow it to make more than `10 files`\n*** \n\n*  `Hard limit` --> Allowing user to make `15 file` so if it exceeds then it won't be able to make `16th file`\n***\n\n* `Grace period` --> Suppose `soft limit` is to allow user `10 files` and `hard limit` is to allow user to make `15` files. When `soft limit` exceeds it can make `11th, 12th upto 15th` files so for how may time it is allowed to keep `11th to 15th file`  in disk is `Grace period`\n\n\n\n# Quota can be implemented in 3 way\n1. On the basis of block size --> meaning `assigning disk-size limit` suppose `1GB` for `1 user` or `group`\n2. On the basis of `I-node` --> meaning `set limit for creating file` suppose `800` files for `1 user` or `group`\n3. can be implemented both `step 1 and step 2`","x":-300,"y":-900,"width":900,"height":540,"color":"1"},
		{"id":"81d5a7d0f9d4fa37","type":"text","text":"# How to make Quota on EXT4\n\n1. create `partition /dev/sdb1` on `/dev/sdb disk`\n2. `mkfs.ext4 /dev/sdb1`'\n3. `blkid /dev/sdb1` for `UUID`\n\nHere, : `For creating quota on disk we require quota package` so let's check whether it is present in system or not\n4. `rpm -qa quota` will give package name \n5. `yum list installed quota` will give package name it don't then install it\n6. `dnf install -y quota`\n\nAlso because `disk quota` is permission which assign to someone it can be \n1. `Users`\n2. `Groups` \n\t1. so let's add `users` and `gruops`\n\t2. `useradd a`\n\t3. `useradd b`\n\t4. `useradd c`\n\t5. `useradd d`\n\t6. `groupadd quotagroup` --> making group name as `quotagroup`\n\t7. `usermod -g quotagroup c` --> adding `user c` and `user d` to `quotagroup`\n\t8. `usermod -g quotagroup d` --> here `-g` meaning primary group meaning `making default group`\n\t9. `id c` will show `user c` information with `group` in which he is belonging\n\t10. `id d`\n\nNow,\n\n7. `mkdir /quota_dir`\n8. `vim /etc/fstab` for permanent mounting\n9. `/dev/sdb1   /quota_dir   ext4   defaults   0   0`\n10. `mount -a` This will mount `/dev/sdb1` on `/quota_dir` permanently\n11. let's check whether quota is enabled or not\n12. `mount | grep quota_dir` this command tell whether quota is enabled or not\n\n\nNow after this just see `Step 2`\n\n","x":-460,"y":-240,"width":1025,"height":940,"color":"1"},
		{"id":"0ff49b005963a316","type":"text","text":"# How to create quota\n1. `Enable quota` so we need to register in `/etc/fstab`\n2. `remount the file-system`\n3. `create quota files`\n4. `configure quota policy`\n\n\n### Step 1 --> Enabling `quota`\n\n1. `vim /etc/fstab`\n2. `/dev/sdb1   /quota_dir   defaults,usrquota,grpquota   0   0`\n\t1. `/dev/sdb1` is disk partition which is `mounted on /quota_dir` having `user-quota and group-quota` enable \n\n\n### Step 2 --> Remounting the file-system\n\n1. Because enabling quota on `/etc/fstab` won't reflect to machine meaning machine don't know about change wo we have to remount the filesystem\n2. `mount -0 remount /quota_dir`\n3. `mount | grep quota_dir` you will see the information with `user-quota and group-quota` enabled\n\n\n### Step 3 --> Creating quota files\n\n1. `quotacheck -cug /quota_dir`\n\t1. `c` meaning `create`\n\t2. `u` meaning `user`\n\t3. `g` meaning `group`\n\t4. `/quota_dir` meaning for which file-system\n2. `cd /quota_dir`\n3. and if you run `ls` you will see\n\t1. `aquota.group`\n\t2. `aquota.user` \n4. `quotacheck -auvg` if it doesn't give error then you good to go\n5. `quotaon /quota_dir` this command is very important if you forgot it then your quota on `/quota_dir` won't work\n\n\n### Step 4 --> Configuring quota policy\n\n* #### for User\n\n1. suppose we want to \n\t1. `set 100MB soft-limit and 200MB for hard-limit` this is `block-size quota` \n\t2. `set 10 inodes for soft-limit and 15 inodes for hard-limit` this is `I-node quota` for user `a`\n2. `edquota a` press enter\n3. you will see the table where you can set the limit for `block: soft and hard limit` and also `inodes: soft and hard-limit`\n4. so you can enter the respective limit to respective column\n5. also remember `1 block = 1KB`, so `for 100MB you need to enter 102400`\n\n* #### for group\n\n1. `edquota -g quotagroup` press enter\n\t1. `-g` meaning for group\n\t2. `quotagroup` is `group name`\n2.  same you will see the table put the limit on respective columns \n3. `ls -ld /quota_dir` you will the permission on directory only `root user and root group` can read-write-execute so let's change permission so anyone can `read-write and execute`\n4. `chmod 777 /quota_dir`\n5. `chgrp quotagroup /quota_dir` making `making quotagroup as group owner`\n6. `ls -ld /quota_dir`\n\n* #### Let's check whether our quota limit is set or not \n\n1. `su -a` switching to user `a` account\n2. `touch a.user{1..10}.txt` allowed because `i-Node soft-limit is 10`\n3. `touch a.user11.txt` allowed with warnings because `i-Node hard-limit is 15` and your `grice period` starts then delete automatically after `grice periods` is over\n4. `touch a.user{12..16}.txt` failed because `i-Node hard-limit is 15` so `16th` file is not allowed\n5. `dd if=/dev/zero of=/quota_dir/myfile.txt bs=1M count=100` it will allow because `block soft-limit for user a is 100MB`\n6. `ls -lh myfile.txt` will shows the details like `size of the file` which is `100MB`\n7. `dd if=/dev/zero of=/quota_dir/myfile.txt bs=1M count=100` it will allow with warnings because `block hard-limit for user a is 200MB` and your `grice period` starts then delete automatically after `grice periods` is over\n8. `ls -lh myfile.txt` will shows the details like `size of the file` which is `100MB + 100MB` = `200MB`\n9. `dd if=/dev/zero of=/quota_dir/myfile.txt bs=1M count=100` failed  because `block hard-limit for user a is 200MB` and we have already used `200MB` for `user a`\n10. `quota a` this will show the details of `quota` like `grace period, I-node limit and block-limit`","x":600,"y":-240,"width":1025,"height":2160,"color":"5"},
		{"id":"96d3375f04f06278","type":"text","text":"Step 1","x":-500,"y":-320,"width":250,"height":60,"color":"3"},
		{"id":"27819e3a6a5f795b","type":"text","text":"# Lets check for `user c` which is belong to `group quotagroup`\nNote :  \n1. Suppose you set\n\t1. `200MB soft-limit and 401MB for hard-limit` this is `block-size quota` \n\t2. `40 inodes for soft-limit and 65 inodes for hard-limit` this is `I-node quota` for group `quotagroup`\n\nNow let's check\n1. `su -c`\n2. because group `quotagroup` has permission on `quota_dir` to `read-write and execute`\n3. `cd /quota_dir`\n4. `let's check for I-Node limit`\n\t1. `touch file{1..40}.txt` will allow because `soft-limit for i-Node is 40 file`\n\t2. `touch file{41..58}.txt` will allow with warning because `hard-limit for i-Node is 60 file` and your `grice period` starts then delete automatically after `grice periods` is over\n\t3. `touch file{59..61}.txt` failed because `hard-limit for i-Node is 60 file`\n5. `let's check for block size limit`\n\t1. `dd if=/dev/zero of=/quota_dir/mygroupfile.txt bs=1M count=204800` it will allow because `block soft-limit for group quotagroup is 200MB`\n    2. `ls -lh mygroupfile.txt` will shows the details like `size of the file` which is `200MB` here `204800` is `200MB`\n    3. `dd if=/dev/zero of=/quota_dir/mygroupfile.txt bs=1M count=204800` it will allow with warnings because `block hard-limit for group quotagroup is 401MB` and your `grice period` starts then delete automatically after `grice periods` is over\n    4. `ls -lh mygroupfile.txt` will shows the details like `size of the file` which is `200MB + 200MB` which is `400MB`\n    5. `dd if=/dev/zero of=/quota_dir/mygroupfile.txt bs=1M count=2048` failed because `block hard-limit for group quotagroup is 401MB`\n    6. `ls -lh mygroupfile.txt` will shows the details like `size of the file` which is `200MB + 200MB + 2MB` which is `402MB` so not allowed\n6. `quota -g quotagroup` this will show the details of `quota` like `grace period, I-node limit and block-limit`\n\n\n\n# How to configure `Grace period` for `users`\n\n1. `quotaoff /quota_dir`\n2. `edquota -T a` press enter\n\t1. `a` is `user name`\n\t2. it will shows the table having columns for `block grace` and `I-node grace`\n\t3. set respective value for respective columns\n\t4. The value of columns can be in \n\t\t1. `seconds` like `20seconds`\n\t\t2. `minutes` like `5minutes`\n3. `quotaon /quota_dir`\n4. `edquota -T a` this time will not show default quota it will show our set quota \n5. remember `grace period` is always set before enabling the quota\n\n\n# How to configure `Grace period` for `groups`\n\n1. `quotaoff /quota_dir`\n2. `edquota -T -g quotagroup` press enter\n\t1. `quotagroup` is `group name`\n\t2. it will shows the table having columns for `block grace` and `I-node grace`\n\t3. set respective value for respective columns\n\t4. The value of columns can be in \n\t\t1. `seconds` like `20seconds`\n\t\t2. `minutes` like `5minutes`\n\t\t3. `days` like `2days`\n3. `quotaon /quota_dir`\n4. `edquota -T -g quotagroup` this time will not show default quota it will show our set quota \n5. remember `grace period` is always set before enabling the quota\n\t","x":1680,"y":-240,"width":1360,"height":1600,"color":"4"},
		{"id":"84c8b0cd9e1109b7","type":"text","text":"Step 3","x":1680,"y":-320,"width":250,"height":60,"color":"3"},
		{"id":"d3a9eb586946fef9","type":"text","text":"#### For users\n\n1. `edquota username` --> used to set quota for `Block and I-Node limit`\n2. `quota username` --> used to see `current quota limit for user`\n3. `edquota -T username` --> used to set `grace period limit`\n\n***\n#### For groups\n\n1. `edquota -g groupname` \n2. `edquota -T -g groupname`\n3. `quota -g groupname`\n\n***\n\n1. `quotaon /quota_dir`\n2. `quotaoff /quota_dir`\n\n\n***NOTE*** : always set `quota grace period` before enabling quota meaning `quataon` other you need to `off` the quota using `quotaoff /quota_dir` then need to set `quota grace period` and then you have to `on` quota using `quotaon /quota_dir`","x":626,"y":-1000,"width":814,"height":640,"color":"5"},
		{"id":"9a78aace6ce44824","type":"text","text":"# Important\n\n1. `repquota -a` \n\t1. This command show all user and all groups quota usage in machine","x":1500,"y":-1000,"width":640,"height":180,"color":"1"}
	],
	"edges":[]
}