{
	"nodes":[
		{"id":"8fcdd34117ad1cbd","x":-400,"y":-320,"width":560,"height":60,"color":"3","type":"text","text":"LVM Snapshot Feature"},
		{"id":"c0cb98a4a083e4b3","x":-648,"y":-240,"width":1057,"height":1500,"color":"1","type":"text","text":"* ***Suppose you have `LVM` filesystem whose**\n1. partition disk name is `/dev/sda1`\n2. volume group name is `dummy_volume`\n3. LVM name is `dummy_lvm`\n4. LVM filesystem is `ext4` \n5. LVM is mounted on `/test_dir`\n\nnow,\n\n***How check size of one directory***\n1. `du -sh /data/`\n2. `/data/` is directory name\n\n* ****How to take backup using LVM Snapshot***\n1. `lvcreate -L 1G -s -n snapshot_data /dev/dummy_volume/dummy_lvm`. here `-s` means snapshot\n2. delete the data from `actual LVM` after snapshot. so that we can restore again using `snapshot`\n\n***NOTE*** : \n1. `The size of snapshot always be more than 20% of LVM space. Ideally it prefer to have equal size of LVM space`\n2. `Because as data grow the snapshot size grow if LVM data is more than snapshot space than our snaphot can currupt.`\n\n*** \n\n* ***How to restore data from snapshot***\n\n1. unmount LVM\n2. `umount /test_dir`\n3. `lvconvert --merge /dev/dummy_volume/snapshot_data`. \n\t1. `/dev/dummy_volume/dummy_lvm` this is `LVM space` path\n\t2. `/dev/dummy_volume/snapshot_data` this is snapshot path\n4. after merge if you run `lvs`. The `snapshot lvm` will not show. because it merged into `actual LVM`. by which it created\n5. now de-activate and re-activate the `actual LVM` i.e. `/dev/dummy_volume/dummy_lvm`. and then mount it to see the restore data\n6. `lvchange -an /dev/dummy_volume/dummy_lvm`. de-activated\n7. `lvs` to see whether it is de-activated\n8. `lvchange -ay /dev/dummy_volume/dummy_lvm` re-activated\n9. `lvs` to see whether it is re-activated\n10. `mount //dev/dummy_volume/dummy_lvm /test_dir`\n11. `df -hT`. verify whether it is mounted or not\n12. `cd /test_dir`\n13. `ll` you will see the restored data.\n14. `du -sh /test_dir` will show exact same size as it was before deletion \n\n\n\n***NOTE*** : \n1. `COW` : Copy own write\n2. meaning on growing `actual LVM size` the snapshot also grow.\n\n***NOTE*** : \n1. If snapshot space is `100%` used that means it is `corrupted`\n2. if you run `grep Snapshot /var/log/messages` it show invalid if Snapshot is corrupted\n3. `lvremove /dev/dummy_volume/snapshot_data`. wise to remove corrupted snapshot. this how we remove \n\n***NOTE*** : \n1. If snapshot space is less than `100%` used that means it is valid snapshot then we can extend it's size\n2. `lvextend -L +1G /dev/dummy_volume/snapshot_data`"},
		{"id":"4b453830d1a32b82","x":-720,"y":-660,"width":712,"height":320,"color":"4","type":"text","text":"***NOTE*** : \n1. `vim /etc/lvm/lvm.conf`\n2. `snapshot_autoextend_threshold` = `70`\n\nHere you can change `snapshot_autoextend_threshold` values which is present in `/etc/lvm/lvm.conf` so when `snapshot lvm size is = 100MB` and if it grows to `150MB`. it will not corrupt ideally it should because `150MB` is more than `100% of space`. but it does not because we mention in file `/etc/lvm/lvm.conf` to extend snapshot `70%` i.e. `100MB + 70MB` = `170MB`. if data is more than `170MB` it will corrupt "}
	],
	"edges":[]
}